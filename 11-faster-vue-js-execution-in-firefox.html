<!doctype html>
<html lang="en">
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<!-- Prevent, to some degree, the execution of inline JavaScript, as well as blocking all plugin content  -->
		<meta http-equiv="Content-Security-Policy" content="script-src 'none'; object-src 'none'; img-src 'none'; font-src 'none'; media-src 'none'; worker-src 'none'; connect-src 'none'; style-src 'self' ">
		<title>Faster Vue.js Execution in Firefox</title>
		<link rel="icon" href="favicon.png" />
		<link rel="stylesheet" href="/a11y-dark.css">
		<link rel="stylesheet" href="/style.css">
	</head>
	<body>
		<main>
		<a target="_blank" rel="noreferrer" href="https://hacks.mozilla.org/2023/09/faster-vue-js-execution-in-firefox/">Go to article URL</a>
		<div id="content"><p></p><p><a href="https://twitter.com/mozhacks/status/1603435347190419456" rel="noreferrer" target="_blank">Speedometer 3</a> is a cross-industry effort to build a modern browser benchmark rooted in real-world user experiences. Its goal is to focus browser engineering effort towards making the Web more smooth for actual users on actual pages. This is hard to do and most browser benchmarks don’t do it well, but we see it as a unique opportunity to improve responsiveness broadly across the Web.</p>
<p>This requires a deliberate analysis of the ecosystem — starting with real user experiences and identifying the essential technical elements underlying them. We built several new tests from scratch, and also updated some existing tests from Speedometer 2 to use more modern versions of widely-used JavaScript frameworks.</p>
<p>When the Vue.js test was updated from Vue 2 to Vue 3, we <a href="https://github.com/WebKit/Speedometer/pull/114#issuecomment-1479368671" rel="noreferrer" target="_blank">noticed</a> some performance issues in Firefox. The root of the problem was <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Proxy" rel="noreferrer" target="_blank">Proxy</a> object usage that <a href="https://vuejs.org/guide/extras/reactivity-in-depth.html#how-reactivity-works-in-vue" rel="noreferrer" target="_blank">was introduced in Vue 3</a>.</p>
<p>Proxies are hard to optimize because they’re generic by design and can behave in all sorts of surprising ways (e.g., modifying trap functions after initialization, or wrapping a Proxy with another Proxy). They also weren’t used much on the performance-critical path when they were introduced, so we focused primarily on correctness in the original implementation.</p>
<p>Speedometer 3 developed evidence that some Proxies today are well-behaved, critical-path, and widely-used. So we <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1824051" rel="noreferrer" target="_blank">optimized these</a> to execute completely in the JIT — specializing for the shapes of the Proxies encountered at the call-site and avoiding redundant work. This makes reactivity in Vue.js significantly faster, and we also anticipate improvements on other workloads.</p>
<p>This change landed in Firefox 118, so it’s currently on Beta and will ride along to Release by the end of September.</p>
<p>Over the course of the year Firefox has improved <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1824051#c25" rel="noreferrer" target="_blank">by around 40%</a> on the Vue.js benchmark from work like this. More importantly, and as we hoped, we’re observing real user metric improvements across all page loads in Firefox as we optimize Speedometer 3. We’ll share more details about this in a subsequent post.</p>
<p>The post <a href="https://hacks.mozilla.org/2023/09/faster-vue-js-execution-in-firefox/" rel="noreferrer" target="_blank">Faster Vue.js Execution in Firefox</a> appeared first on <a href="https://hacks.mozilla.org" rel="noreferrer" target="_blank">Mozilla Hacks - the Web developer blog</a>.</p>
<p></p></div>
		<div class="content-meta">
			<time datetime=2023-09-05T16:39:32.000Z>5 September 2023</time>
			<a href="/urls/hacks-mozilla-org-feed">hacks.mozilla.org/feed/</a>
			<div> <a href="/tags/web-platform.html">web-platform</a> |  <a style="font-weight: bold" href="/tags/source.html">source</a></div>
		</div>
	</main>
		<footer>
			<nav>
				<a href="/">Home</a>
				<a href="/tags">Tags</a>
				<a href="/urls">URLs</a>
				<a rel="noreferrer" target="_blank" href="https://github.com/thoughtsunificator/rss-feed-static-generator">Source code</a>
			</nav>
		</footer>
		<script src="/highlight.min.js"></script>
		<script>hljs.highlightAll();</script>
		</body>
</html>