<!doctype html>
<html lang="en">
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<!-- Prevent, to some degree, the execution of inline JavaScript, as well as blocking all plugin content  -->
		<meta http-equiv="Content-Security-Policy" content="script-src 'none'; object-src 'none'; img-src 'none'; font-src 'none'; media-src 'none'; worker-src 'none'; connect-src 'none'; style-src 'self' ">
		<title>Anomaly detection with few labeled samples under distribution mismatch</title>
		<link rel="icon" href="favicon.png" />
		<link rel="stylesheet" href="/a11y-dark.css">
		<link rel="stylesheet" href="/style.css">
	</head>
	<body>
		<main>
		<a target="_blank" rel="noreferrer" href="http://opensource.googleblog.com/2024/05/semi-supervised-anomaly-detection-under-distribution-mismatch.html">Go to article URL</a>
		<div id="content"><p></p><meta content="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiuBFLDUYvL0gw4ujrAhHJTJH5sZURPEtRGdMU2FcyBo7Y083veDn3R7D0FuTD9AXbm5YTmFHGlFPPFjPwf10kJC5ZNQ5H1YKtA1RAFHji7KRIqitnvBjLVZw10_u1tr_FSZFSE0PpE9fq_M5gqQVgEJgdGJgz-w3qahByE22Bchz01jAdrAxygUzJa_R4/s1600/social%20%283%29.png" name="twitter:image">


<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiDXBT5jkQpF6yB9yp6ioOqWVrPW9cV8R8wN-ruLK31intOmsqjDvEM35feN6-PJfZOebcz_JgPASl7Zq7xGKi-i5UgadliqWs66rXzp2EogKBPWXkywM8jssfnLoU0cEVE0jIWpcqVJwzhYinypKEfLKbAfL6rEVYNqfuaeWa9JRUHZMmcWt7MV2QrRdc/s1600/header%20%283%29.png" rel="noreferrer" target="_blank"></a>


<div><br></div>

<h2><b>SPADE: Semi-Supervised Anomaly Detection under Distribution Mismatch</b></h2><br>

<h3><b>What is SPADE?</b></h3>

<p>Recently, we have open-sourced <a href="https://github.com/google-research/spade_anomaly_detection" target="_blank" rel="noreferrer">SPADE</a> (<b>S</b>emi-supervised <b>P</b>seudo-labeler <b>A</b>nomaly <b>D</b>etection with <b>E</b>nsembling), a semi-supervised framework for anomaly detection that overcomes some of the drawbacks of alternative anomaly detection methods.</p><br>

<h3><b>What Problem does SPADE Solve?</b></h3>

<p>Anomaly detection is the process of identifying samples in a dataset that diverge from some expected pattern. This process has wide applications in several industries such as <a href="https://cloud.google.com/apigee/docs/api-security/abuse-detection" target="_blank" rel="noreferrer">API security</a>, <a href="https://cloud.google.com/blog/products/data-analytics/anomaly-detection-using-streaming-analytics-and-ai" target="_blank" rel="noreferrer">financial fraud</a> and <a href="https://cloud.google.com/blog/products/ai-machine-learning/improve-manufacturing-quality-control-with-visual-inspection-ai" target="_blank" rel="noreferrer">manufacturing defect detection</a>. SPADE is especially designed for semi-supervised settings where we have a handful of labeled data and a large number of unlabeled data.</p><br>

<h3><b>When is SPADE better for your Use Case?</b></h3>

<p>Creating a large labeled set of anomalous and non-anomalous samples for supervised learning can be time-consuming, expensive and error-prone. So unsupervised and semi-supervised methods have become an active area of research.</p> 

<p>Most of these semi-supervised methods make the assumption that the labeled and unlabeled data come from the same distribution, that is, they are generated by the same underlying process—physical, financial, manufacturing or other process. This assumption is often violated in different ways—the labeled data could contain one type of anomaly while the unlabeled data contains other types of anomalies; or the labeled data could only contain samples that were easy to label. In these and potentially other cases, SPADE has been shown to have better performance than alternatives.</p><br>

<h3><b>How does it Work?</b></h3>

<p>SPADE constructs an ensemble of <a href="https://en.wikipedia.org/wiki/One-class_classification" target="_blank" rel="noreferrer">One-Class Classifiers (OCCs)</a>; each OCC is a Gaussian Mixture Model trained in a self-supervised manner on a disjoint subset of the unlabeled samples and non-anomalous samples.</p>

<div><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container"><tbody><tr><td><center></center></td></tr><tr><td class="tr-caption"><i><b>Figure 1.</b> SPADE first trains an ensemble of OCC to provide pseudo-labels to the unlabeled samples. Then, both labeled and pseudo-labeled samples are used to train a supervised model for the anomaly detection.</i></td></tr></tbody></table></div><br>

<p>The ensemble is used to obtain pseudo-labels for the unlabeled data. A pseudo-label of <span>is-anomalous</span>  or <span>not-anomalous</span> is assigned only if all the members of the ensemble agree. The pseudo-labels and any original labels are used together to train a supervised anomaly detector model. In the version of SPADE that we are open-sourcing, this model is a Tensorflow Random Forest that is trained with a binary cross-entropy loss. Once trained on the labels and pseudo-labels, the detector model can be used for online or batch prediction.</p><br>

<h3><b>Example Use Cases</b></h3>

<p>The above described benefits of SPADE are highlighted in our experiments as detailed in the published paper (in TMLR with feature certification). Here we present some results on a selection of datasets that demonstrate SPADE performance when (a) there are new types of anomalies in the unlabeled dataset, (b) when the labeled anomalies are easy to label, and (c) when the dataset contains only positively labeled and unlabeled samples.</p>


<div><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container"><tbody><tr><td><center></center></td></tr><tr><td class="tr-caption"><i><b>Figure 2.</b> SPADE performance compared against other supervised, semi-supervised and unsupervised methods. Details about the datasets and the methods can be found in our <a href="https://openreview.net/pdf?id=JwDpZSv3yz" target="_blank" rel="noreferrer">paper</a>.</i></td></tr></tbody></table></div><br>

<p>As shown in Figure 2, SPADE consistently outperforms alternative methods. The CoverType and Thyroid datasets have Creative Commons Attribution 4.0 International (CC BY 4.0) licenses and are present in the <a href="https://github.com/google-research/spade_anomaly_detection" target="_blank" rel="noreferrer">SPADE repository</a>.</p><br>

<h3><b>How to use SPADE</b></h3>

<p>We have just <a href="https://github.com/google-research/spade_anomaly_detection" target="_blank" rel="noreferrer">open-sourced SPADE</a>. The repository contains scripts that build a Docker container and push the container, then run the container as a <a href="https://cloud.google.com/vertex-ai/docs/training/create-custom-job" target="_blank" rel="noreferrer">Vertex Custom Job</a> on Google Cloud Platform. The dataset is read from <a href="https://cloud.google.com/bigquery?hl=en" target="_blank" rel="noreferrer">BigQuery</a>. Metrics such as AUC, Precision and Recall can currently be tracked in the job logs. The job launch script is configured with a default set of hyperparameters as described in the <a href="https://github.com/google-research/spade_anomaly_detection/blob/main/README.md" target="_blank" rel="noreferrer">documentation</a>. Users may need to adjust the hyperparameters to obtain optimal performance. The final trained anomaly detection model artifact is written to <a href="https://cloud.google.com/storage?hl=en" target="_blank" rel="noreferrer">Google Cloud Storage</a> (GCS). This artifact can be deployed as a <a href="https://cloud.google.com/vertex-ai/docs/pipelines/model-endpoint-component" target="_blank" rel="noreferrer">Vertex Endpoint</a> to serve predictions (not demonstrated in this repository).</p><br>

<h3><b>Ways to Help</b></h3>

<p>By <a href="https://github.com/google-research/spade_anomaly_detection" target="_blank" rel="noreferrer">open sourcing SPADE</a>, we hope to foster more usage of this innovative anomaly detection method in the community, as well as invite contributions to improve the method. The SPADE model and code is freely available on Github under the Apache-2.0 license. SPADE is currently set up to run in a Docker container as a <a href="https://cloud.google.com/vertex-ai/docs/training/create-custom-job" target="_blank" rel="noreferrer">Vertex Custom Job</a> on Google Cloud Platform. It can also be run by installing from <a href="https://pypi.org/project/spade-anomaly-detection/" target="_blank" rel="noreferrer">PyPi</a> using <span>pip install spade-anomaly-detection</span>. Users can upload their dataset to BigQuery, and run the training job on Vertex, or on a local machine from the PyPi installation.</p>

<p>More detailed usage instructions are available in the <a href="https://github.com/google-research/spade_anomaly_detection/blob/main/README.md" target="_blank" rel="noreferrer">documentation</a>.</p>

<p><em>By Raj Sinha and Jinsung Yoon, Cloud AI Research Team</em></p>




<p></p></div>
		<div class="content-meta">
			<time datetime=2024-05-30T09:00:00.000Z>30 May 2024</time>
			<a href="/urls/feeds-feedburner-com-googleopensourceblog">feeds.feedburner.com/GoogleOpenSourceBlog</a>
			<div> <a href="/tags/open-source.html">open-source</a> |  <a style="font-weight: bold" href="/tags/source.html">source</a></div>
		</div>
	</main>
		<footer>
			<nav>
				<a href="/">Home</a>
				<a href="/tags">Tags</a>
				<a href="/urls">URLs</a>
				<a rel="noreferrer" target="_blank" href="https://github.com/thoughtsunificator/rss-feed-static-generator">Source code</a>
			</nav>
		</footer>
		<script src="/highlight.min.js"></script>
		<script>hljs.highlightAll();</script>
		</body>
</html>