<!doctype html>
<html lang="en">
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<!-- Prevent, to some degree, the execution of inline JavaScript, as well as blocking all plugin content  -->
		<meta http-equiv="Content-Security-Policy" content="script-src 'none'; object-src 'none'; img-src 'none'; font-src 'none'; media-src 'none'; worker-src 'none'; connect-src 'none'; style-src 'self' ">
		<title>An OpenStreetMap Editor for Adding Public Transit Data Using GTFS</title>
		<link rel="icon" href="favicon.png" />
		<link rel="stylesheet" href="/a11y-dark.css">
		<link rel="stylesheet" href="/style.css">
	</head>
	<body>
		<main>
		<a target="_blank" rel="noreferrer" href="https://www.endpointdev.com/blog/2024/05/an-openstreetmap-editor-for-incorporating-gtfs-data/">Go to article URL</a>
		<div id="content"><p></p>
        <p></p>
<p>You can think of OpenStreetMap (OSM) as Wikipedia for maps. While it may not be as well known as Google Maps or Apple Maps, OSM becomes indispensable when you need data, rather than just a visual representation on your phone. The only other real option for data retrieval is to consult a local agency, so if you’re in search of a comprehensive and global cartographic dataset, OSM is the go-to choice.</p>
<p>OSM also excels in providing navigation for pedestrians and cyclists. For the past decade, I’ve navigated the US, Canada, and Europe using OSM through the OsmAnd app, a dedicated Android application for OpenStreetMap.</p>
<p>Overall, my experience has been quite positive, except for one significant weakness: public transportation. Specifically, I’ve been missing the convenient access to timetables for buses, trams, or any other form of public transit.</p>
<p>A significant part of the challenge in making public transportation data readily available on OSM and its associated applications is the fact that the OSM data model isn’t particularly well suited for this type of information. While OSM can store the location of bus and train stops, the actual timetables change so often that keeping them up to date in OSM is essentially impossible.</p>
<p>Enter the General Transit Feed Specification (GTFS), a widely adopted standard for managing public transportation data. I wanted to explore ways to integrate OSM with GTFS effectively.</p>
<h3 id="my-openstreetmap-editor-for-gtfs-data">My OpenStreetMap editor for GTFS data</h3>
<p>A simple approach for addressing this challenge would be to overlay an OSM map with stops from GTFS. While this would be relatively straightforward, it doesn’t leverage OSM’s biggest strength—its vibrant community. One of OSM’s most significant advantages is that it dynamically incorporates user contributions: as soon as the community accesses useful data, members enhance the details and accuracy of its mapping data. Therefore, I’ve been working on truly integrating GTFS data with OSM, creating a cohesive mapping experience rather than settling for a disjointed overlay.</p>
<p>Although the implementation is a bit trickier, I believe the better approach for handling this challenge involves merging GTFS stops with those already present in OSM and incorporating GTFS stop codes into OSM data. Hence, I’ve developed a single-page online editor. This tool facilitates the creation, editing, and deletion of stops within OSM. It also highlights stops based on their alignment with stops specified in a given GTFS file.</p>
<p>Editing the routes wasn’t a priority, yet I found it necessary to match GTFS routes and trips with OSM routes and their variants. Displaying trips shows which part of a street a route uses and also which side of a street bus stops are located on.</p>
<p>I’ve deployed the app on my GitHub, where you can try it out: <a href="https://kiselev-dv.github.io/osm-gtfs/" rel="noreferrer" target="_blank">https://kiselev-dv.github.io/osm-gtfs/</a>.</p>
<h3 id="how-to-use-the-app">How to use the app</h3>
<p>To start, download a GTFS data dump. They are usually published by local transit companies. As an example, I’ll use data from Halifax, Nova Scotia.</p>
<p>Open the GTFS ZIP file in the editor. The editor should parse stops from GTFS.</p>
<p></p>
<p>Next, query OSM data and select “OSM Tag with GTFS stop code.” After OSM data is loaded you will get OSM tags statistics which might help you to see if there are some popular tag combination for GTFS data in the area. OSM doesn’t have strict data model, but as a rule of thumb for that type of data <code>ref</code> or <code>gtfs:ref</code> should work. If there are multiple agencies sharing a stop and each of them publishes its own GTFS data, you can use something like <code>gtfs:&lt;agency_name&gt;:ref</code>. By default the editor will substitute the most popular tag containing <code>ref</code> or <code>gtfs</code>.</p>
<p>Now you can match stops from OSM with stops from GTFS. Matches are color coded:</p>
<ul>
<li>Blue: matching stops</li>
<li>Red: stops which are present in GTFS but not mapped in OSM (stops to add)</li>
<li>Black: stops mapped in OSM but not matched with GTFS stop (probably outdated stops which are no longer in use and may be deleted, or stops not used by the agency whose GTFS data you are using)</li>
</ul>
<p></p>
<h3 id="adding-stops-to-osm">Adding stops to OSM</h3>
<p>There are two main cases for adding or matching a stop:</p>
<ul>
<li>There is no stop in OSM at all and we want to create a new one</li>
<li>There is a stop in OSM and we want to edit it and add GTFS data</li>
</ul>
<p>Select one of the GTFS stops. On the left panel there will be two buttons: “Create” and “Assign”.</p>
<p></p>
<p>The “Create” button will switch the map into satellite mode, create a new OSM stop with GTFS code, and add a stop name at the point where you click. When creating a stop or editing its location, pay attention to which side of the road it should be on. To simplify that, you can highlight one of the routes in the “Routes on this stop” section.</p>
<p></p>
<p>The “Assign” button allows you to select one of the existing OSM stops, and set its GTFS code.</p>
<p></p>
<h3 id="demo-videos">Demo videos</h3>
<p>You can see a <a href="https://www.youtube.com/watch?v=fG_RvC7AWfk" rel="noreferrer" target="_blank">video on my YouTube channel</a> with the latest updates to the editor, along with a live editing session.</p>
<p>I have also created a <a href="https://www.youtube.com/playlist?list=PL0eKSR1VCpIQiTntglaVhKXt4PKWTcEg6" rel="noreferrer" target="_blank">YouTube playlist</a> with more demos.</p>
<h3 id="an-important-note">An important note</h3>
<p>An important note is that I do not upload results directly into OSM. Instead, I generate an XML file for an OSM changeset which you can view and edit in JOSM or another editor. I do this partly so I do not have to deal with authentication, but more importantly, because I see editing public transport relations in OSM as an advanced topic and it makes sense for editors to demonstrate a higher level of sophistication than general users. But I might change my mind about this if I get feedback that it would be desirable.</p>
<p>My app is built using React and Leaflet. You can find the code on my GitHub: <a href="https://github.com/kiselev-dv/osm-gtfs" rel="noreferrer" target="_blank">https://github.com/kiselev-dv/osm-gtfs</a></p>

      <p></p></div>
		<div class="content-meta">
			<time datetime=2024-05-08T00:00:00.000Z>8 May 2024</time>
			<a href="/urls/www-endpointdev-com-blog-feed-xml">www.endpointdev.com/blog/feed.xml</a>
			<div> <a href="/tags/programming.html">programming</a> |  <a href="/tags/reporting.html">reporting</a></div>
		</div>
	</main>
		<footer>
			<nav>
				<a href="/">Home</a>
				<a href="/tags">Tags</a>
				<a href="/urls">URLs</a>
				<a rel="noreferrer" target="_blank" href="https://github.com/thoughtsunificator/rss-feed-static-generator">Source code</a>
			</nav>
		</footer>
		<script src="/highlight.min.js"></script>
		<script>hljs.highlightAll();</script>
		</body>
</html>